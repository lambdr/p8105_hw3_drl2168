P8105: Homework 3
================
Derek Lamb
2023-10-08

I will load all necessary packages here. I also am including the code
that Dr. Goldsmith showed in class, to set figure color and size
preferences. I have modified it slightly: I prefer `theme_bw()` over
`theme_minimal()` and I may change the color scheme from the default
`viridis`.

``` r
library(tidyverse)
library(knitr)

opts_chunk$set(
  fig.width = 6,
  out.width = "90%"
)

## These are options that i'm going to treat as default for now
## I don't love viridis, but don't have a better option yet
theme_set(theme_bw() + theme(legend.position = "bottom"))

options(
  ggplot2.continuous.colour = "viridis",
  ggplot2.continuous.fill = "viridis"
)

scale_colour_discrete = scale_colour_viridis_d
scale_fill_discrete = scale_fill_viridis_d
```

# Problem 1

``` r
# Load data from the provided package
library(p8105.datasets)
data("instacart")
```

### Data set size, user behavior

This data set is massive, containing 1384617 observations of 15
variables. Each row is a specific item from an order, in total 131209
orders are included from 131209 unique users. There appear to be no
repeat orders from users in this data set, although 828824 items are
items that were previously ordered by that user. This accounts for 60%
of the orders, showing that only a small portion of instacart activity
is captured by this data set. There are no first-time orders in this
data set; this is on average order number 17 for users (median order
number 11 ). On average, users placed their orders 17.1 days after their
previous one.

### Aisles & products

There are 134 unique aisles included in the data set. In the following
code chunk, I’ll find the most ordered from aisles.

``` r
instacart |> 
  group_by(aisle) |> 
  summarize(n_obs = n()) |> 
  arrange(desc(n_obs)) |> 
  head() |> 
  kable(col.names = c("Aisle", "Number of Orders"))
```

| Aisle                         | Number of Orders |
|:------------------------------|-----------------:|
| fresh vegetables              |           150609 |
| fresh fruits                  |           150473 |
| packaged vegetables fruits    |            78493 |
| yogurt                        |            55240 |
| packaged cheese               |            41699 |
| water seltzer sparkling water |            36617 |

The two most ordered from aisles are fresh vegetables and fresh fruits,
with about 150,000 orders each. Below, you can see a plot of all aisles
with more than 10,000 orders.

``` r
instacart |> 
  group_by(aisle) |> 
  summarize(n_obs = n()) |> 
  filter(n_obs >=10000) |> 
  ggplot(aes(y = reorder(aisle, n_obs), x = n_obs)) +
  geom_bar(alpha = .9, stat = "identity") + 
  labs(
    title = "Instacart aisles with more than 10,000 orders",
    x = "Number of orders",
    y = "Aisle"
  )
```

<img src="p8105_hw3_drl2168_files/figure-gfm/aisle plot-1.png" width="90%" />

### Q1c

``` r
instacart |> 
  group_by(aisle, product_name) |> 
  filter(aisle == "baking ingredients" | aisle == "dog food care" | aisle == "packaged vegetables fruits") |> 
  summarize(n_obs = n()) |> 
  filter(min_rank(desc(n_obs)) <= 3) |> 
  mutate(
    rank = min_rank(desc(n_obs)),
    item = paste(product_name, " (", as.character(n_obs),")", sep = "")
         ) |> 
  select(-product_name, -n_obs) |> 
  pivot_wider(
    names_from = aisle,
    values_from = item
  ) |> 
  arrange(rank) |> 
  kable(col.names = c("Rank", "Baking Ingredients", "Dog Food & Care", "Packaged Vegatables & Fruits"), label = "Most popular items from three aisles", caption = "Item (n)")
```

| Rank | Baking Ingredients      | Dog Food & Care                                    | Packaged Vegatables & Fruits |
|-----:|:------------------------|:---------------------------------------------------|:-----------------------------|
|    1 | Light Brown Sugar (499) | Snack Sticks Chicken & Rice Recipe Dog Treats (30) | Organic Baby Spinach (9784)  |
|    2 | Pure Baking Soda (387)  | Organix Chicken & Brown Rice Recipe (28)           | Organic Raspberries (5546)   |
|    3 | Cane Sugar (336)        | Small Dog Biscuits (26)                            | Organic Blueberries (4966)   |

Item (n)
